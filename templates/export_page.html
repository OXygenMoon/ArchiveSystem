{% extends "layout.html" %}

{% block title %} 导出数据 {% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>导出系部违纪数据</h2>
    <hr>
    <p>点击下面的按钮将导出您所在系部 (<b>{{ user_department }}</b>) 的所有违纪记录为 Excel (.xlsx) 文件。</p>

    {# 显示 flash 消息（如果后端使用了 flash） #}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category or 'info' }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <a href="{{ url_for('export_excel') }}" class="btn btn-success" download>
        <i class="fas fa-file-excel"></i> 导出 Excel 文件
    </a>
    {# 或者使用 button 包装 link #}
    {#
    <button type="button" class="btn btn-success" onclick="window.location.href='{{ url_for('export_excel') }}'">
        <i class="fas fa-file-excel"></i> 导出 Excel 文件
    </button>
     #}

    <p class="mt-3 text-muted small">文件名将包含系部和当前日期。</p>

</div>
{% endblock %}